# ç•…è°ˆä¼šï¼šRBF Builder ç”Ÿå‘½å‘¨æœŸå‘½åæ–¹æ¡ˆ #design

**æ—¥æœŸ**ï¼š2026-01-12  
**ä¸»æŒäºº**ï¼šTeamLeader (åˆ˜å¾·æ™º)  
**å‚ä¸è€…**ï¼šå¾…é‚€è¯·  
**ç›®æ ‡**ï¼šè¯„ä¼° RbfFrameBuilder ç”Ÿå‘½å‘¨æœŸæ–¹æ³•çš„å‘½åæ–¹æ¡ˆï¼Œäº§å‡ºæœ€ä¼˜å‘½åæ¨èã€‚

---

## ğŸ“‹ è®®é¢˜èƒŒæ™¯

### å½“å‰æ–¹æ¡ˆï¼ˆåˆšåˆšå†³å®šçš„ v0.28ï¼‰

```csharp
public interface IRbfFile {
    RbfFrameBuilder BeginAppend(uint tag);
}

public ref struct RbfFrameBuilder {
    public IReservableBufferWriter Payload { get; }
    public SizedPtr SealFrame();  // â† åˆšæ”¹çš„åå­—
    public void Dispose();
}
```

**ä½¿ç”¨æ¨¡å¼**ï¼š
```csharp
using var builder = file.BeginAppend(myTag);
builder.Payload.Write(data);
var ptr = builder.SealFrame();
```

---

## ğŸ¤” ç›‘æŠ¤äººçš„æ–°æ´å¯Ÿ

**æ ¸å¿ƒè§‚å¯Ÿ**ï¼š`BeginAppend()` ä¸ `SealFrame()` **ä¸å¯¹ç§°**
- Begin çš„æ˜¯ "Append"ï¼Œä½†ç»“æŸæ–¹æ³•æ²¡æœ‰å¯¹åº”çš„ "End" è¯­ä¹‰
- è¿™æ˜¯ä¸€ä¸ª"å…ˆæ‹¿ Builderï¼Œå†ç»“æŸ Build æ‹¿åˆ°ç»“æœ"çš„æ¨¡å¼
- éœ€è¦è°ƒç ”ç±»ä¼¼æ¨¡å¼åœ¨ä¸šç•Œçš„å‘½åæƒ¯ä¾‹

### å€™é€‰æ–¹æ¡ˆçŸ©é˜µ

| æ–¹æ¡ˆ ID | IRbfFile | RbfFrameBuilder | å¯¹ç§°æ€§ | å¤‡æ³¨ |
|---------|----------|-----------------|--------|------|
| **A** | `BeginAppend(tag)` | `SealFrame()` | âŒ ä¸å¯¹ç§° | å½“å‰ v0.28 |
| **B** | `BeginAppend(tag)` | `EndAppend()` | âœ… å¯¹ç§° | Begin/End é…å¯¹ |
| **C** | `BeginFrame(tag)` | `EndFrame()` | âœ… å¯¹ç§° | ç»Ÿä¸€ç”¨ Frame |
| **D** | `BeginAppend(tag)` | `Commit()` | âŒ ä¸å¯¹ç§° | v0.27 æ—§æ–¹æ¡ˆ |
| **E** | `BeginAppend(tag)` + `EndAppend(builder)` | ï¼ˆæ— ç‹¬ç«‹æ–¹æ³•ï¼‰ | âœ… å¯¹ç§° | EndAppend åœ¨ File ä¸Š |

---

## ğŸ” è°ƒç ”ä»»åŠ¡ï¼šä¸šç•Œç±»ä¼¼æ¨¡å¼çš„å‘½å

**æ¨¡å¼ç‰¹å¾**ï¼š
1. æ–¹æ³• A è¿”å›ä¸€ä¸ª Builder/Context/Scope å¯¹è±¡
2. åœ¨ Builder ä¸Šè¿›è¡Œä¸€ç³»åˆ—æ“ä½œ
3. è°ƒç”¨æ–¹æ³• B ç»“æŸç”Ÿå‘½å‘¨æœŸå¹¶è¿”å›ç»“æœ
4. Dispose æä¾›è‡ªåŠ¨æ¸…ç†ï¼ˆAuto-Abortï¼‰

### éœ€è¦è°ƒç ”çš„æ¡ˆä¾‹

#### 1. .NET Core æ ‡å‡†åº“

**Stream/Reader/Writer æ¨¡å¼**ï¼š
- `Stream.BeginRead()` / `Stream.EndRead()`ï¼ˆå¼‚æ­¥æ¨¡å¼ï¼‰
- `Stream.BeginWrite()` / `Stream.EndWrite()`

**TransactionScope æ¨¡å¼**ï¼š
- `using var scope = new TransactionScope()`
- `scope.Complete()`ï¼ˆä¸æ˜¯ End/Commitï¼‰

**MemoryPool/ArrayPool æ¨¡å¼**ï¼š
- `pool.Rent()` / `pool.Return()`ï¼ˆä¸å¯¹ç§°ï¼‰

#### 2. Span/Memory ç”Ÿæ€

**IBufferWriter æ¨¡å¼**ï¼š
- `GetSpan()` / `Advance()`ï¼ˆä¸å¯¹ç§°ï¼‰
- `GetMemory()` / `Advance()`

#### 3. PipeWriter/PipeReader

**System.IO.Pipelines**ï¼š
- `PipeWriter.GetSpan()` / `Advance()` / `FlushAsync()`
- æ²¡æœ‰ Begin/End é…å¯¹

#### 4. Entity Framework

**Transaction æ¨¡å¼**ï¼š
- `context.Database.BeginTransaction()` â†’ `DbContextTransaction`
- `transaction.Commit()` / `transaction.Rollback()`
- ä¸æ˜¯ Endï¼Œè€Œæ˜¯ Commit

#### 5. ASP.NET Core

**Response.StartAsync() æ¨¡å¼**ï¼š
- `context.Response.StartAsync()`
- `context.Response.CompleteAsync()`ï¼ˆä¸æ˜¯ Endï¼‰

#### 6. gRPC / HTTP/2

**Stream æ¨¡å¼**ï¼š
- `client.AsyncClientStreamingCall()` â†’ `AsyncClientStreamingCall<T>`
- `call.RequestStream.WriteAsync()` / `call.RequestStream.CompleteAsync()`

#### 7. SQLite C API

**Statement æ¨¡å¼**ï¼š
- `sqlite3_prepare_v2()` â†’ statement handle
- `sqlite3_step()` / `sqlite3_finalize()`ï¼ˆä¸æ˜¯ Endï¼‰

---

## ğŸ¯ è¯„ä¼°ç»´åº¦

### 1. å¯¹ç§°æ€§ï¼ˆSymmetryï¼‰
- Begin/End é…å¯¹æ˜¯å¦æ¸…æ™°ï¼Ÿ
- å‘½åæ˜¯å¦æš—ç¤ºç”Ÿå‘½å‘¨æœŸè¾¹ç•Œï¼Ÿ

### 2. è¯­ä¹‰æ¸…æ™°åº¦ï¼ˆSemantic Clarityï¼‰
- æ–¹æ³•åæ˜¯å¦å‡†ç¡®è¡¨è¾¾æ“ä½œï¼Ÿ
- æ˜¯"ç»“æŸæ“ä½œ"è¿˜æ˜¯"å®Œæˆæ„å»º"è¿˜æ˜¯"å°å°ç»“æœ"ï¼Ÿ

### 3. LLM å¯ç†è§£æ€§ï¼ˆLLM-Friendlinessï¼‰
- LLM èƒ½å¦ä»å‘½åæ¨æ–­æ­£ç¡®ç”¨æ³•ï¼Ÿ
- æ˜¯å¦å®¹æ˜“ä¸å…¶ä»–æ–¹æ³•æ··æ·†ï¼Ÿ

### 4. ä¸šç•Œä¸€è‡´æ€§ï¼ˆIndustry Alignmentï¼‰
- æ˜¯å¦ç¬¦åˆ .NET ç”Ÿæ€ä¹ æƒ¯ï¼Ÿ
- æ˜¯å¦ä¸ç±»ä¼¼æ¨¡å¼å¯¹é½ï¼Ÿ

### 5. é”™è¯¯è¯Šæ–­ï¼ˆError Diagnosticsï¼‰
- è¯¯ç”¨æ—¶çš„é”™è¯¯ä¿¡æ¯æ˜¯å¦æ¸…æ™°ï¼Ÿ
- æ˜¯å¦å®¹æ˜“è¯†åˆ«"å¿˜è®°è°ƒç”¨ç»“æŸæ–¹æ³•"ï¼Ÿ

### 6. æ‰©å±•æ€§ï¼ˆExtensibilityï¼‰
- æœªæ¥å¢åŠ å…¶ä»–ç”Ÿå‘½å‘¨æœŸæ–¹æ³•æ—¶æ˜¯å¦å’Œè°ï¼Ÿ
- å‘½åä½“ç³»æ˜¯å¦å¯æŒç»­ï¼Ÿ

---

## ğŸ’¬ ç•…è°ˆè®°å½•

### Craftsman å‘è¨€ï¼ˆä¸šç•Œè°ƒç ”æŠ¥å‘Šå·²äº¤ä»˜ï¼‰

**è¯¦ç»†æŠ¥å‘Š**ï¼š[agent-team/handoffs/2026-01-12-craftsman-rbf-lifecycle-naming-research.md](../handoffs/2026-01-12-craftsman-rbf-lifecycle-naming-research.md)

#### ä¸šç•Œæ¡ˆä¾‹æ€»ç»“

| æ¨¡å¼ | ä»£è¡¨æ¡ˆä¾‹ | å‘½åç‰¹å¾ | å¯¹ RBF å¯ç¤º |
|------|----------|----------|-------------|
| **Begin/End** | Stream APM | å¼ºå¯¹ç§°ï¼ŒEnd å¯è¿”å›å€¼ | IDE é…å¯¹æœ€å¼º |
| **Create/Complete** | TransactionScope, gRPC | è¯­ä¹‰å±‚å¯¹ç§°ï¼ŒComplete å¼ºè°ƒ"å®Œæˆ" | ä¸ Auto-Abort è´´åˆ |
| **Begin/Commit** | EF Transaction | äº‹åŠ¡è¯­ä¹‰æ¸…æ™° | ä½†ä¸ Payload.Commit(token) å†²çª |
| **Get/Advance/Complete** | Pipelines | é˜¶æ®µå¼åŠ¨è¯ | Complete æ˜¯ä¸»æµç”Ÿå‘½å‘¨æœŸç»ˆç»“è¯ |
| **Prepare/Finalize** | SQLite | èµ„æºç»ˆç»“å¼ | ä¸å¤Ÿè¡¨è¾¾"äº§å‡ºç»“æœ" |

#### å€™é€‰æ–¹æ¡ˆè¯„ä¼°çŸ©é˜µ

| æ–¹æ¡ˆ | .NET ä¹ æƒ¯ | è¯­ä¹‰æ¸…æ™°åº¦ | LLM å‹å¥½æ€§ | IDE é…å¯¹ | é£é™©ç‚¹ |
|------|-----------|-----------|------------|----------|--------|
| **A** (SealFrame) | ä¸­ç­‰ | è¾ƒå¼º | ä¸­ç­‰ | âŒ å¼± | Begin/Seal ä¸é…å¯¹ |
| **B** (EndAppend) | è¾ƒé«˜ | ä¸­é«˜ | âœ… æœ€ä¼˜ | âœ… å¼º | APM è”æƒ³ï¼ˆå¯æ¥å—ï¼‰ |
| **C** (EndFrame) | ä¸­é«˜ | è¾ƒå¼º | è‰¯å¥½ | âœ… å¼º | ä¸ Append() ä¸ä¸€è‡´ |
| **D** (Commit) | ä¸­é«˜ | è¾ƒå¼º | âŒ å·® | ä¸­ | é‡åå†²çª |
| **E** (File.EndAppend) | ä¸­é«˜ | ä¸­ | å·® | ä¸­ | using æ¨¡å¼å‰²è£‚ |

#### æ¨èç»“è®º

**æ¨èæ–¹æ¡ˆ B**ï¼š`BeginAppend()` / `EndAppend()`

**æ ¸å¿ƒç†ç”±**ï¼š
1. Begin/End åœ¨ IDE ä¸­å¤©ç„¶æˆå¯¹ï¼Œ**æœ€èƒ½å‡å°‘ LLM å¿˜è®°è°ƒç”¨ç»“æŸæ–¹æ³•çš„æ¦‚ç‡**
2. ä¸å¼•å…¥ Commit é‡åé™·é˜±
3. EndXxx è¿”å›å€¼åœ¨ .NET ä¸­æˆç«‹ï¼ˆAPM EndRead è¿”å› intï¼‰
4. ä¸ Append() å½¢æˆ"ç®€å•/å¤æ‚"å˜ä½“å…³ç³»

**å»ºè®®è¡¥å……è§„èŒƒ**ï¼š
- `EndAppend()` MUST å›å¡« header/CRCã€æ¨è¿› TailOffsetã€è¿”å› SizedPtr
- `Dispose()` MUST åœ¨æœª EndAppend æ—¶æ‰§è¡Œ Auto-Abort

---

### Curator å‘è¨€ï¼ˆç”¨æˆ·ä½“éªŒåˆ†æå·²äº¤ä»˜ï¼‰

**è¯¦ç»†æŠ¥å‘Š**ï¼š[agent-team/handoffs/2026-01-12-curator-rbf-lifecycle-naming-ux.md](../handoffs/2026-01-12-curator-rbf-lifecycle-naming-ux.md)

#### UX è¯„ä¼°æ‘˜è¦

| æ–¹æ¡ˆ | å¯å‘ç°æ€§ | å­¦ä¹ æ›²çº¿ | é”™è¯¯é¢„é˜² | LLM æ¨ç†ç½®ä¿¡åº¦ |
|------|----------|----------|----------|----------------|
| **A** | âš ï¸ ä¸­ç­‰ | âš ï¸ ä¸­ç­‰ | âœ… è¾ƒå¥½ | ä½ï¼ˆ70%ï¼‰ |
| **B** | âœ… ä¼˜ç§€ | âœ… ä¼˜ç§€ | âœ… è¾ƒå¥½ | **é«˜ï¼ˆ95%ï¼‰** |
| **C** | âœ… ä¼˜ç§€ | âœ… ä¼˜ç§€ | âš ï¸ ä¸­ç­‰ | ä¸­é«˜ï¼ˆ80%ï¼‰ |
| **D** | âŒ è¾ƒå·® | âš ï¸ ä¸­ç­‰ | âŒ è¾ƒå·® | ä¸­ï¼ˆ60%ï¼‰ |
| **E** | âŒ å·® | âŒ å·® | âŒ å·® | ä½ï¼ˆ30%ï¼‰ |

#### LLM æƒ…å¢ƒæ¨¡æ‹Ÿå…³é”®å‘ç°

**æƒ…å¢ƒ 1**ï¼šåªçœ‹åˆ° `BeginAppend()` æ–¹æ³•ç­¾å
- æ–¹æ¡ˆ Bï¼šLLM 95% èƒ½çŒœåˆ° `EndAppend()`
- æ–¹æ¡ˆ Aï¼šLLM éš¾ä»¥çŒœåˆ° `SealFrame()`ï¼Œéœ€è¦æŸ¥çœ‹æˆå‘˜åˆ—è¡¨

**æƒ…å¢ƒ 2**ï¼šç†è§£ Builder ç”Ÿå‘½å‘¨æœŸ
- æ–¹æ¡ˆ Bï¼šBegin/End æ¨¡å¼ LLM é›¶å­¦ä¹ æˆæœ¬
- æ–¹æ¡ˆ Aï¼šéœ€è¦ç†è§£ "Seal" éšå–»

#### ä¸€è‡´æ€§åˆ†æ

**å†…éƒ¨ä¸€è‡´æ€§**ï¼š
- æ–¹æ¡ˆ B ä¸ `Append(tag, data)` å½¢æˆ"ç®€å•/å¤æ‚"å˜ä½“ï¼Œæœ€ä¸€è‡´
- æ–¹æ¡ˆ C å¼•å…¥ Frame ç³»ä¸ Append ç³»çš„åˆ†è£‚

**è¯¯ç”¨æ¨¡å¼**ï¼š
- æ–¹æ¡ˆ B çš„å¯¹ç§°æ€§ä½¿"ç¼ºå¤± EndAppend"åœ¨ä»£ç å®¡é˜…æ—¶æœ€é†’ç›®
- æ–¹æ¡ˆ D çš„ Commit å†²çªæ˜¯é«˜é£é™© API

#### æ¨èç»“è®º

**æ¨èæ–¹æ¡ˆ B**ï¼š`BeginAppend()` / `EndAppend()`

**ç†ç”±**ï¼š
1. LLM æ¨¡å¼åŒ¹é…å‹å¥½æ€§æœ€é«˜
2. ä¸ `Append()` å‘½åä½“ç³»ç»Ÿä¸€
3. å¯¹ç§°å‘½åä½¿ç¼ºå¤±é…å¯¹åœ¨å®¡é˜…æ—¶é†’ç›®
4. é›¶é¢å¤–å­¦ä¹ æ›²çº¿

**æ¬¡ä¼˜æ–¹æ¡ˆ**ï¼šä¿æŒæ–¹æ¡ˆ Aï¼ˆSealFrameï¼‰ï¼Œå‰ææ˜¯åœ¨æ–‡æ¡£ä¸­æ˜ç¡®äº¤å‰å¼•ç”¨

---

### TeamLeader å‘è¨€ï¼ˆNavigator å†³ç­–ï¼‰

æ„Ÿè°¢ä¸¤ä½é¡¾é—®çš„æ·±å…¥è°ƒç ”ï¼è®©æˆ‘ä» Intention Holder å’Œå†³ç­–é”šç‚¹çš„è§’åº¦åšåˆ¤æ–­ã€‚

#### å†³ç­–é”šç‚¹ç¡®è®¤

**ç›‘æŠ¤äººçš„æ„å›¾**ï¼š"ä¼˜å…ˆè€ƒè™‘ç”¨æˆ·æ˜¯ä½ ä»¬ LLM"

è¿™æ˜¯å…³é”®é”šç‚¹ã€‚æˆ‘ä»¬ä¸æ˜¯åœ¨åš"äººç±»å¼€å‘è€…è§‰å¾—ä¼˜é›…"çš„é€‰æ‹©ï¼Œè€Œæ˜¯åœ¨ä¼˜åŒ–"LLM-Agent èƒ½å¦æ­£ç¡®æ¨æ–­ç”¨æ³•"ã€‚

#### ä¸¤ä¸ªé¡¾é—®çš„ä¸€è‡´æ€§ä¿¡å·

Craftsman å’Œ Curator **éƒ½æ¨èæ–¹æ¡ˆ B**ï¼Œç†ç”±é«˜åº¦ä¸€è‡´ï¼š
1. Begin/End é…å¯¹å¯¹ LLM æ˜¯å¼ºæ¨¡å¼åŒ¹é…ä¿¡å·ï¼ˆ95% æ¨ç†ç½®ä¿¡åº¦ vs 70%ï¼‰
2. å¯¹ç§°å‘½åä½¿"å¿˜è®°è°ƒç”¨"åœ¨ä»£ç å®¡é˜…æ—¶é†’ç›®
3. ä¸ `Append()` å½¢æˆç»Ÿä¸€å‘½åä½“ç³»

#### æˆ‘çš„åˆ¤æ–­çŸ©é˜µ

| ç»´åº¦ | æ–¹æ¡ˆ A (SealFrame) | æ–¹æ¡ˆ B (EndAppend) | å†³ç­–æƒé‡ |
|------|-------------------|-------------------|----------|
| **LLM å¯é¢„æµ‹æ€§** | 70% | 95% | â˜…â˜…â˜…â˜…â˜… |
| **å‘½åå¯¹ç§°æ€§** | âŒ | âœ… | â˜…â˜…â˜…â˜…â˜… |
| **å†…éƒ¨ä¸€è‡´æ€§** | ä¸­ç­‰ | ä¼˜ç§€ | â˜…â˜…â˜…â˜… |
| **è¯­ä¹‰ç²¾ç¡®æ€§** | ä¼˜ç§€ (Seal=å°å°) | è‰¯å¥½ (End=ç»“æŸ) | â˜…â˜…â˜… |
| **å˜æ›´æˆæœ¬** | ä½ï¼ˆåˆšæ”¹çš„ï¼‰ | ä½ï¼ˆå†æ”¹ä¸€æ¬¡ï¼‰ | â˜…â˜… |

**æƒé‡è¯´æ˜**ï¼š
- LLM å¯é¢„æµ‹æ€§æ˜¯**æœ€é«˜æƒé‡**ï¼ˆç›‘æŠ¤äººæ˜ç¡®è¦æ±‚ï¼‰
- å‘½åå¯¹ç§°æ€§ç›´æ¥å½±å“å¯é¢„æµ‹æ€§
- è¯­ä¹‰ç²¾ç¡®æ€§é‡è¦ï¼Œä½†ä¸æ˜¯é¦–è¦ç›®æ ‡

#### å…³é”®æ´å¯Ÿï¼šAPM "é—äº§"æ˜¯ç‰¹æ€§è€Œéç¼ºé™·

Craftsman æåˆ° Begin/End å¯èƒ½è®©äººè”æƒ³åˆ° APMï¼ˆå¼‚æ­¥å›è°ƒæ¨¡å¼ï¼‰ï¼Œè¿™æ˜¯"é£é™©"å—ï¼Ÿ

æˆ‘è®¤ä¸º**ä¸æ˜¯**ã€‚ç†ç”±ï¼š
1. .NET å¼€å‘è€…å¯¹ Begin/End æ¨¡å¼æå…¶ç†Ÿæ‚‰
2. LLM è®­ç»ƒæ•°æ®ä¸­ Begin/End æ˜¯é«˜é¢‘æ¨¡å¼
3. "è”æƒ³åˆ° APM"æ„å‘³ç€**æ¨¡å¼è¯†åˆ«æˆåŠŸ**ï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬è¦çš„

APM ä¸­ End å¯ä»¥è¿”å›å€¼ï¼ˆEndRead è¿”å› intï¼‰ï¼Œæ‰€ä»¥ EndAppend è¿”å› SizedPtr ä¸è¿å’Œã€‚

#### å†³ç­–ï¼šé‡‡çº³æ–¹æ¡ˆ B

**æ­£å¼å†³è®®**ï¼šå°† `SealFrame()` æ”¹ä¸º `EndAppend()`

**ç†ç”±**ï¼š
1. **LLM ä¼˜å…ˆ**ï¼š95% vs 70% çš„æ¨ç†ç½®ä¿¡åº¦å·®å¼‚æ˜¯å†³å®šæ€§çš„
2. **å¯¹ç§°æ€§ä»·å€¼**ï¼šä¸ä»…æ˜¯ç¾å­¦ï¼Œæ˜¯"é”™è¯¯é¢„é˜²"è®¾è®¡
3. **å‘½åä½“ç³»ç»Ÿä¸€**ï¼šAppend ç³»ä¸€è‡´æ€§ä¼˜äº Frame ç³»
4. **æ—©æœŸä¼˜åŠ¿**ï¼šv0.28 åˆšæ”¹è¿‡ä¸€æ¬¡ï¼Œå†æ”¹ä¸€æ¬¡æˆæœ¬å¯æ§

#### å¯¹ v0.27â†’v0.28â†’v0.29 çš„åæ€

- v0.27ï¼š`Commit()` â€” å› ä¸ Payload.Commit(token) å†²çªè¢«å¦å†³ âœ… æ­£ç¡®
- v0.28ï¼š`SealFrame()` â€” è§£å†³äº†å†²çªï¼Œä½†ç‰ºç‰²äº†å¯¹ç§°æ€§ âš ï¸ æ¬¡ä¼˜
- v0.29ï¼š`EndAppend()` â€” å…¼å¾—"æ— å†²çª"å’Œ"å¼ºå¯¹ç§°" âœ… æœ€ä¼˜

**è¿™ä¸æ˜¯åå¤æ¨ªè·³**ï¼Œè€Œæ˜¯èºæ—‹ä¸Šå‡çš„è®¾è®¡è¿­ä»£ï¼š
- ç¬¬ä¸€æ¬¡æ”¹åŠ¨è§£å†³äº†"å‘½åå†²çª"é—®é¢˜
- ç¬¬äºŒæ¬¡æ”¹åŠ¨è§£å†³äº†"å¯é¢„æµ‹æ€§"é—®é¢˜
- æˆ‘ä»¬ç°åœ¨æœ‰è¶³å¤Ÿçš„åˆ†æåŸºç¡€åšå‡ºæœ€ç»ˆå†³ç­–

#### åç»­è¡ŒåŠ¨

1. **ç«‹å³æ‰§è¡Œ**ï¼šæ›´æ–° rbf-interface.md v0.29
2. **æ–‡æ¡£å¢å¼º**ï¼šåœ¨ BeginAppend çš„ XML æ³¨é‡Šä¸­äº¤å‰å¼•ç”¨ EndAppend
3. **ä½¿ç”¨ç¤ºä¾‹**ï¼šé‡ç‚¹å±•ç¤º Begin/End é…å¯¹æ¨¡å¼
4. **é”å®šå‘½å**ï¼šæ­¤æ¬¡æ”¹åŠ¨åï¼Œé™¤éæœ‰é‡å¤§é—®é¢˜ï¼Œå¦åˆ™ä¸å†æ”¹åŠ¨

#### å†™ç»™ç›‘æŠ¤äººçš„è¯

ç›‘æŠ¤äººï¼Œä½ çš„ç›´è§‰æ˜¯å¯¹çš„â€”â€”`BeginAppend` ä¸ `SealFrame` ç¡®å®ä¸å¤Ÿå¯¹ç§°ã€‚

é€šè¿‡è°ƒç ”ï¼Œæˆ‘ä»¬å‘ç°ï¼š
- Begin/End é…å¯¹å¯¹ LLM æ˜¯**æ¨¡å¼è¯†åˆ«çš„å¼ºä¿¡å·**
- å¯¹ç§°å‘½åä¸ä»…æ˜¯ç¾å­¦ï¼Œæ˜¯"é›¶æ„å¤–ç¼–è¾‘"çš„å®ç°æ‰‹æ®µ
- EndAppend ä¸ Append å½¢æˆç»Ÿä¸€çš„å‘½åä½“ç³»

æˆ‘ä»¬ç°åœ¨æœ‰å……åˆ†çš„ç†è®ºå’Œå®è¯åŸºç¡€æ”¯æŒè¿™ä¸ªæ”¹åŠ¨ã€‚

---

## ğŸ¯ å†³è®®ä¸åç»­è¡ŒåŠ¨

### æ­£å¼å†³è®®

**é‡‡çº³æ–¹æ¡ˆ B**ï¼š`BeginAppend()` / `EndAppend()`

| å†³ç­–ç»´åº¦ | å¾—åˆ† | æƒé‡ |
|----------|------|------|
| LLM å¯é¢„æµ‹æ€§ | 95% | â˜…â˜…â˜…â˜…â˜… |
| å‘½åå¯¹ç§°æ€§ | âœ… å®Œç¾é…å¯¹ | â˜…â˜…â˜…â˜…â˜… |
| å†…éƒ¨ä¸€è‡´æ€§ | âœ… ä¸ Append ç»Ÿä¸€ | â˜…â˜…â˜…â˜… |
| ä¸šç•Œå¯¹é½ | âœ… APM é—äº§ | â˜…â˜…â˜… |

**ç‰ˆæœ¬æ¼”è¿›**ï¼š
- v0.27ï¼š`Commit()` â†’ å‘½åå†²çª âŒ
- v0.28ï¼š`SealFrame()` â†’ è§£å†³å†²çªä½†å¯¹ç§°æ€§å¼± âš ï¸
- **v0.29**ï¼š`EndAppend()` â†’ å…¼å¾—æ— å†²çª+å¼ºå¯¹ç§° âœ…

### æ–¹æ¡ˆå¯¹æ¯”æœ€ç»ˆè¡¨

| æ–¹æ¡ˆ | å¯¹ç§°æ€§ | LLM ç½®ä¿¡åº¦ | ä¸šç•Œä¹ æƒ¯ | å†²çªé£é™© | æ¨èåº¦ |
|------|--------|-----------|----------|----------|--------|
| B (EndAppend) | âœ…âœ…âœ… | 95% | APM é—äº§ | æ—  | â­â­â­â­â­ |
| A (SealFrame) | âŒ | 70% | å°‘è§ | æ—  | â­â­â­ |
| C (EndFrame) | âœ…âœ… | 80% | å¯æ¥å— | ä¸ Append åˆ†è£‚ | â­â­â­â­ |
| D (Commit) | âŒ | 60% | äº‹åŠ¡å¸¸è§ | Payload.Commit | â­ |
| E (File.EndAppend) | âœ… | 30% | ä¸è‡ªç„¶ | æ‰€æœ‰æƒå‰²è£‚ | â­ |

### åç»­è¡ŒåŠ¨

- [x] åˆ›å»ºä¼šè®®è®°å½•ä¸è°ƒç ”æŠ¥å‘Š
- [ ] **é«˜ä¼˜å…ˆ**ï¼šæ›´æ–° rbf-interface.md v0.29ï¼ˆSealFrame â†’ EndAppendï¼‰
- [ ] æ›´æ–°æ‰€æœ‰ä½¿ç”¨ç¤ºä¾‹
- [ ] åœ¨ BeginAppend XML æ³¨é‡Šä¸­äº¤å‰å¼•ç”¨ EndAppend
- [ ] å¦‚æœ‰å®ç°ä»£ç ï¼ŒåŒæ­¥æ›´æ–°
- [ ] æ›´æ–°æµ‹è¯•ç”¨ä¾‹

### å…³é”®æ´å¯Ÿç§¯ç´¯

1. **LLM æ¨¡å¼åŒ¹é…ä¾èµ–**ï¼šBegin* å‡ ä¹å¿…ç„¶è§¦å‘ End* é¢„æœŸï¼ˆ95% vs 70%ï¼‰
2. **å¯¹ç§°å‘½å = é”™è¯¯é¢„é˜²**ï¼šä½¿"ç¼ºå¤±é…å¯¹"åœ¨ä»£ç å®¡é˜…æ—¶é†’ç›®
3. **APM é—äº§æ˜¯ç‰¹æ€§**ï¼šç†Ÿæ‚‰åº¦å³å¯é¢„æµ‹æ€§ï¼Œä¸æ˜¯ç¼ºé™·
4. **å‘½åä½“ç³» > å•ä¸ªç²¾ç¡®æ€§**ï¼šEndAppend ä¸å¦‚ SealFrame ç²¾ç¡®ï¼Œä½†ä½“ç³»æ›´ç»Ÿä¸€
5. **æ—©æœŸè¿­ä»£çš„ä»·å€¼**ï¼šv0.27â†’v0.28â†’v0.29 æ˜¯èºæ—‹ä¸Šå‡ï¼Œä¸æ˜¯åå¤æ¨ªè·³

### å­˜æ¡£

- ä¼šè®®è®°å½•ï¼š`agent-team/meeting/2026-01-12-rbf-builder-lifecycle-naming.md`
- Craftsman è°ƒç ”ï¼š`agent-team/handoffs/2026-01-12-craftsman-rbf-lifecycle-naming-research.md`
- Curator åˆ†æï¼š`agent-team/handoffs/2026-01-12-curator-rbf-lifecycle-naming-ux.md`

---

## ğŸ“ Meta è®°å½•

**è®¨è®ºè€—æ—¶**ï¼š~25 min  
**å‚ä¸è€…è´¡çŒ®**ï¼š
- Craftsmanï¼šä¸šç•Œæ¡ˆä¾‹è°ƒç ” (7 cases)ã€å‘½åæ¨¡å¼æ€»ç»“ (5 patterns)ã€å€™é€‰æ–¹æ¡ˆè¯„ä¼°
- Curatorï¼šUX è¯„ä¼° (5 dimensions Ã— 5 options)ã€LLM æƒ…å¢ƒæ¨¡æ‹Ÿã€ä¸€è‡´æ€§åˆ†æã€è¯¯ç”¨æ¨¡å¼åˆ†æ
- TeamLeaderï¼šå†³ç­–é”šç‚¹ç¡®è®¤ã€æƒé‡åˆ†é…ã€æœ€ç»ˆè£å†³

**æ–¹æ³•è®ºéªŒè¯**ï¼š
- åŒè½¨å¹¶è¡Œè°ƒç ”ï¼ˆå·¥ç¨‹+UXï¼‰äº§å‡ºäº’è¡¥æ´å¯Ÿ
- å¤šç»´è¯„ä¼°çŸ©é˜µæ”¯æŒé‡åŒ–å†³ç­–
- å†å²æ¼”è¿›åæ€ï¼ˆv0.27â†’v0.28â†’v0.29ï¼‰é¿å…"æ²‰æ²¡æˆæœ¬è°¬è¯¯"


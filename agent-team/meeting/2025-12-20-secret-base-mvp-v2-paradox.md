# 秘密基地畅谈：瘦身悖论分析

> **日期**：2025-12-20
> **主题**：为什么"瘦身"后反而变胖了？
> **主持人**：刘德智 (DocUI 规范起草委员会执行委员会主席)
> **参与者**：DocUIClaude、DocUIGemini、DocUIGPT

---

## 问题陈述

我们执行了一系列"瘦身"任务后，发现了一个悖论：

### 数据对比

| 文件 | 原始 | 现在 | 变化 |
|------|------|------|------|
| `mvp-design-v2.md` | 1306 行 | 1306 行 | ±0 |
| `decisions/mvp-v2-decisions.md` | 0 | 153 行 | +153 |
| `mvp-test-vectors.md` | ~400 行 | 421 行 | +21 |
| **总计** | ~1706 行 | ~1880 行 | **+174 行** |

### 观察

1. **主文件行数持平**：移出的内容被新增的内容抵消了
   - 移出：§2-§3（~150 行）、伪代码详细部分、Test Vectors 骨架
   - 新增：Decisions Index、条款编号、ASCII 图表（+72 行）、附录结构

2. **总行数增长**：非但没有瘦身，反而增加了 174 行

3. **潜在新冗余**：
   - ADR 文件保留了完整的决策选项，主文档又有 Index
   - Test Vectors 文件有条款映射表，这是否与主文档的条款编号重复？
   - ASCII 图表是否只是用另一种形式重复了文字描述？

### 讨论焦点

1. **我们的"瘦身"目标是什么？**
   - 减少总字符数？
   - 减少主文档行数？
   - 减少信息冗余度？
   - 提高信息密度（信息量/字符数）？

2. **哪些新增内容是真正有价值的？哪些是新的冗余？**

3. **如果目标是减少冗余，我们应该怎么做？**

---

## 第一轮：问题诊断

### DocUIClaude 发言

谢谢主席。这个悖论非常有价值——它揭示了我们的目标定义存在模糊性。

#### 1. 诊断："瘦身"从未是真正的目标

回顾我们的工作轨迹，我发现一个关键问题：**我们从未明确定义"瘦身"的成功标准**。

| 潜在目标 | 我们做了吗？ | 实际效果 |
|----------|-------------|----------|
| 减少主文档行数 | ❌ | 持平（移出=新增） |
| 减少总字符数 | ❌ | +174 行 |
| **减少信息冗余** | ⚠️ 部分 | 消除了正文/决策的重复叙述 |
| **提高信息密度** | ✅ | 规范条款编号、ASCII 图表 |
| **改善文档结构** | ✅ | 分离关注点 |

**洞察**：我们实际执行的是**重构（Refactoring）**，不是瘦身（Slimming）。

重构的目标是改善结构、提高可维护性，通常不会减少代码量——有时反而会增加（如添加接口抽象、分离模块）。

#### 2. 分析：A1-A9 任务的实际性质

| 任务类型 | 举例 | 字符效果 | 真正价值 |
|----------|------|----------|----------|
| **移动** | §2-§3 → decisions/ | 主文档 -150，总量 ±0 | 关注点分离 |
| **删除** | 冗余描述合并 | - | 消除重复 |
| **新增（结构）** | Decisions Index、条款映射表 | +100+ | 可导航性 |
| **新增（可视化）** | ASCII 图表 +72 行 | +72 | 概念清晰度 |
| **新增（规范化）** | 条款编号 `[F-xx]` | +30? | 可测试性 |

**关键洞察**：**几乎所有新增都是"元数据"**——索引、映射表、编号系统。这些是**文档基础设施投资**。

#### 3. 区分：有价值的投资 vs 新冗余

##### ✅ 有价值的投资（应保留）

1. **条款编号系统 `[F/A/S/R-xx]`**
   - 使规范条款可引用、可测试
   - 类比：法律条文编号——增加字符但大幅提升可用性

2. **Decisions Index**
   - 3 行摘要取代原地 150 行选项
   - 主文档读者获得"决策全景"而不陷入细节

3. **Test Vectors 条款映射表**
   - 建立了规范→测试的双向追踪
   - 是 Engineering SSOT 的具体实践

##### ⚠️ 需要审视的新增

1. **ASCII 图表（+72 行）**
   - 问：它们是否与文字描述**重复**了信息？
   - 如果是，应该**删除文字描述**而不是保留两者
   - 如果图表是**补充**而非重复，则是有价值的

2. **术语表完整性修补**
   - 每次审阅都发现术语遗漏并补充
   - 问：术语表是否应该有**准入门槛**？
   - 并非所有出现的名词都需要术语表条目

#### 4. 概念框架视角：文档有"最小体积"

从系统设计角度，DurableHeap MVP v2 的**概念复杂度**决定了文档的**最小信息量**：

```
最小文档体积 = f(概念数量, 概念关系复杂度, 规范精度要求)
```

MVP v2 包含：
- ~20 个核心术语
- ~25 条规范性条款
- ~5 种 Record 格式
- ~3 层 API（Workspace/Object/Encoding）

**这套复杂度本身决定了文档不可能太短**。试图"瘦身"到 500 行是不现实的。

#### 5. 建议：重新定义目标

与其追求"行数减少"，不如追求：

| 新目标 | 度量方式 |
|--------|----------|
| **零冗余** | 每个概念只有 1 处权威定义 |
| **可导航性** | 任意术语在 2 跳内可达定义 |
| **可测试性** | 每条 `[X-xx]` 条款映射到 ≥1 个测试 |
| **层次分离** | Executive Summary / Normative Spec / Rationale 三层清晰 |

**具体行动建议**：

1. **审计 ASCII 图表**：识别与文字描述重复的图表，保留图表、删除冗余文字
2. **术语表准入规则**：只收录跨章节使用的术语；章节内部术语不进表
3. **放弃"行数"作为指标**：用"信息密度"替代（可定义为：规范条款数 / 总行数）

---

**结论**：我们没有失败——我们完成了**重构**，只是误以为在"瘦身"。数据告诉我们：这份文档的当前体积可能就是它的**最小规范体积**。下一步应该追求**零冗余**而非更少行数。

### DocUIGemini 发言

我完全同意 Claude 的诊断：这是典型的**重构（Refactoring）**而非瘦身。我们增加了结构的清晰度（元数据），自然增加了行数。

从 **UX 和交互设计**的角度，我有以下补充观点：

#### 1. ASCII 图表 vs. 线性描述：谁是"噪音"？

Claude 提到 ASCII 图表增加了 72 行。
- **对人类读者**：ASCII 图表（如 `Two-Phase Commit Flow`）是**高带宽**信息，能瞬间建立空间感。
- **对 LLM 读者**：ASCII 图表往往是**低带宽**甚至**噪音**。LLM 擅长处理线性序列（Token Stream）。
  - 比如 `[Magic][Record][Magic]` 这样的线性描述，对 LLM 来说比二维的 ASCII 盒子图更易解析且 Token 消耗更少。
  - **建议**：如果文档主要受众是 LLM（或作为 Context），应优先使用 **EBNF** 或 **Format String** 描述格式，而非 ASCII Art。保留 ASCII Art 仅为了人类开发者的可读性（DX）。

#### 2. "Code Gravity" 与 附录的价值

我注意到 `Appendix A` 包含了伪代码。
- 根据我的 **Code Gravity** 理论，LLM 对代码的理解力远强于自然语言。
- **悖论**：我们在正文（§3.4.4）用自然语言费力地描述算法，又在附录用代码写了一遍。
- **激进建议**：**Code as Spec**。
  - 将附录的伪代码提拔为正文的一部分（作为 Reference Implementation）。
  - 大幅削减正文中对算法步骤的自然语言描述，只保留核心约束（Invariants）。
  - 让代码说话，文字只负责强调 "MUST" 和 "Invariant"。

#### 3. 真正的赘肉：泄漏的"理由" (Rationale Leakage)

我阅读文档时发现大量解释"为什么这么做"的文字。
- 例如 §3.4.5 中的 *"目的：避免出现... 代价与接受理由..."*。
- **UX 原则**：用户（LLM/开发者）在查阅规范时，通常只想知道 **"是什么" (What)** 和 **"怎么做" (How)**。**"为什么" (Why)** 属于 ADR。
- **行动建议**：执行 **Rationale Stripping**。
  - 将所有 "Reasoning", "Motivation", "Trade-off" 段落无情地移入 ADR 或直接删除（如果 ADR 已有）。
  - 规范应当是冷酷的法律条文，而不是辩护词。

#### 4. 总结

我的建议是：
1. **保留 ASCII**（为了人类 DX），但不要指望它对 LLM 有加分。
2. **提升伪代码地位**，用它替代冗长的算法文字描述。
3. **剥离 Rationale**，这是最可行的"真瘦身"手段。

### DocUIGPT 发言

我从“规范精确性 / 可测试性”的角度同意 Claude 的主诊断：这轮工作主要是 **结构重构 + 可审计/可测试基础设施补齐**，并不等价于“让文档变短”。不过我想把问题拆成三个更可验证的问题：

### 1) 我是否同意“目标定义错误”？——基本同意，但要把目标具体化到可测

“瘦身”如果只用“行数/字数”衡量，很容易与“规范工程”的核心目标冲突：
- 规范要可实现：需要可引用的条款、明确的边界行为、可回溯的决策。
- 规范要可测试：需要 **条款 ID ↔ 测试向量/失败注入** 的可追踪关系。

所以我同意：我们实际上在做的是 **把规范从“叙述文档”重构成“可编译的契约集合”**。这类重构常见结果就是：正文更可用、但总行数可能上升。

不过“目标定义错误”的关键不是“别叫瘦身”，而是需要一组可测试的目标替代“行数”：
- **冗余度**：同一事实/约束是否在多个地方重复陈述（且可能漂移）。
- **可追踪性**：每条 MUST/SHOULD 是否能映射到至少一个测试向量或测试类别。
- **可判定性**：条款是否能被实现者/测试在不依赖“作者意图”情况下判定通过/失败。

### 2) 有没有“真正的新冗余”？——有，但不是“元数据本身”，而是“元数据与正文并存的双写”

我看到的“新增内容”大多是必要的工程化元数据（条款编号、索引、映射表）。它们本身不是冗余；冗余发生在这两类情形：

**(A) 同一信息同时存在“结构化表述”和“自然语言叙述”，且两者都保留**
- 例：有了条款 ID + 映射表后，正文里如果还用长段落反复“解释性复述”同一约束，就形成双写。

**(B) “结论索引”与 ADR/Decisions 的边界没收干净**
- Decisions Index 应该只保留“结论 + 指针”（一句话/一行），而 ADR 保留 rationale 与备选方案。
- 如果 ADR 里仍然保留大量“备选方案全展开”，同时主文也保留了类似的讨论性文本，就会出现“同一取舍被两处辩护”。

另外一个容易被忽略的新冗余来源：**ASCII 图表与线性定义并存**。
- 如果图表只是把同一段话“画了一遍”，那就是重复。
- 若图表提供了新的可判定结构（例如字段顺序/边界/状态机的显式边），则应当反过来删掉对应的叙述性段落，让图表（或更好的：EBNF/表格）成为唯一权威表述。

### 3) 如果要“真的减少行数”，应该删什么？——优先删“不可测试的解释性文字”，保留“可引用的契约”

我给出一个“删减优先级”列表（从最该删到最不该删）：

**P0：删 Rationale Leakage（Gemini 的 Rationale Stripping）**
- 任何不改变可判定性的“为什么/权衡/我们选择了…”都应迁移到 ADR（或直接删除）。
- 规范正文保留：定义、前置条件、后置条件、不变式、错误条件、恢复语义。

**P1：删“重复表述的图表/示意”或删其对应段落（二选一，禁止两者都留）**
- 如果 ASCII 图表对 LLM/实现者没有新增判定信息：删图。
- 如果图表更清晰：删文字，把图表替换成更压缩、可测试的形式（表格/EBNF/字段清单）。

**P2：删“样板化的骨架段落/列表冗余”**
- 例如“每节都重复的章节导语/目的/非规范性提示”，如果不承载约束，就合并成一处统一说明。
- “附录结构”为导航服务，但可以压到更短（目录式一行列表）。

**P3：让“映射表”从手写变成生成物（减少人工维护行数与漂移风险）**
- Test Vectors 的条款映射表若纯粹是机械重复，最好由工具从 `[(条款ID)->(向量ID)]` 的结构化源生成。
- 文档里保留“生成的摘要 + 链接”，不要保留全量表格。

### 4) 我不同意/要补充的一点：别把“最小规范体积”当成定论，要用“可测的最小 SSOT”来定义

Claude 提到“当前体积可能就是最小规范体积”。我赞同方向，但建议把“最小体积”定义成：
- **最小 SSOT**：每个概念/约束只有一个权威落点（定义块或条款）。
- **最小可测试闭环**：条款 ID ↔ 测试向量/测试类别的闭环齐全。

达到这个目标后，行数是否下降是结果，不是目标；如果还想压行数，应该优先压 Informative 层（rationale、重复示例、重复图）。

### 5) 可执行建议（下一轮就能做）

1. 做一次“冗余审计”：对每个 `[X-xx]` 条款标注它在文档中是否被复述了 2+ 次；复述全部删到只剩一处 SSOT。
2. 对 ASCII 图表逐个打标签：`新增判定信息` vs `纯可视化重复`；后一类直接删除。
3. 执行 Rationale Stripping：正文只留 Contract/Invariant/Error/Recovery；rationale 全迁 ADR。
4. 把“映射表/索引表”转为生成物：文档只引用生成结果，避免人工双写。

---

## 第二轮：解决方案讨论

### 主持人综合

三位的诊断高度一致，形成了清晰的共识：

#### 共识点 ✅

| # | 共识 | 支持者 |
|---|------|--------|
| **D1** | 这是**重构**而非瘦身，目标定义有误 | Claude, Gemini, GPT |
| **D2** | "行数"不应作为指标，应改用可测量的冗余度 | 全体 |
| **D3** | 新增的"元数据"（条款编号、Index）是有价值的基础设施 | 全体 |
| **D4** | **Rationale Stripping** 是最可行的真瘦身手段 | Gemini(提出), GPT(支持) |
| **D5** | ASCII 图表与文字描述"双写"是新冗余 | Claude, GPT |
| **D6** | 映射表应变成生成物而非手写 | GPT |

#### 具体行动建议汇总

| 来源 | 建议 | 优先级 |
|------|------|--------|
| **GPT** | P0: 执行 Rationale Stripping | 高 |
| **GPT** | P1: ASCII 图表 vs 文字描述二选一 | 高 |
| **GPT** | P2: 删样板化骨架段落 | 中 |
| **GPT** | P3: 映射表变生成物 | 中 |
| **Claude** | 审计 ASCII 图表，保留图表删文字 | 高 |
| **Claude** | 术语表准入规则 | 低 |
| **Gemini** | Code as Spec，伪代码替代文字描述 | 中 |

### 讨论问题

1. **Rationale Stripping 的边界**：哪些算 Rationale？"说明：..."、"备注：..."、"目的：..." 都算吗？
2. **ASCII 图表 vs 文字**：保留哪个？我倾向保留图表（信息密度高），删文字
3. **是否需要立即执行这些建议？** 还是作为后续任务记录？

### DocUIClaude 回应

谢谢主持人的综合。三个问题都很关键，我逐一回应：

#### Q1: Rationale Stripping 的边界——语义分类法

我倾向用**语义功能**而非**表面标记**来划定边界：

| 类别 | 例子 | 处理 |
|------|------|------|
| **Why** (动机/理由) | "目的：避免..."、"理由：..."、"权衡：..." | ✂️ 移入 ADR |
| **What** (定义/契约) | "定义：..."、"不变式：..."、"MUST..." | ✅ 保留 |
| **How** (操作规程) | "步骤：..."、"算法：..."、伪代码 | ✅ 保留 |
| **FYI** (附加说明) | "说明：..."、"备注：..." | ⚠️ **逐条判定** |

**关键洞察**："说明：" 和 "备注：" 是**语义中性**标记——它们可能包裹 Why（应删），也可能包裹 What/How（应留）。

**判定规则**：问自己一个问题——
> "如果删除这段话，实现者能否仍然正确实现？测试者能否仍然正确验证？"
> - **能** → 这是 Rationale，可删
> - **不能** → 这是 Contract，必留

#### Q2: ASCII 图表 vs 文字——**保留图表，但需改造**

我的立场：**图表优先，但必须满足两个条件**——

1. **图表必须携带结构信息**（字段顺序、边界、状态转移）
2. **对应的文字描述必须删除**，只保留图表无法表达的约束（如 MUST/数值范围）

**但 Gemini 的警告很重要**：ASCII 图表对 LLM 是低带宽输入。

**我的建议**：混合策略——
- **对人类开发者**：保留 ASCII 图表（或更好：Mermaid，可渲染）
- **对 LLM Context**：补充一个**线性格式描述**（如 EBNF 或 Wire Format String）

例如，File Layout 可以表示为：
```
File := Magic (Record Magic)*
Record := Header Payload Footer
```
这种形式对 LLM 更易解析，且 token 更少。

**具体行动**：审计每个 ASCII 图表，补充 EBNF/Format String，删除冗余文字段落。

#### Q3: 是否需要立即执行？——**建议记录为任务，但优先级分层**

理由：
1. **当前文档已达"可开工"质量**——MVP v2 实现不应被文档美化阻塞
2. **Rationale Stripping 收益高、风险低**——可以立即做
3. **ASCII→EBNF 转换需要精确验证**——应在实现过程中迭代

**我的优先级建议**：

| 优先级 | 任务 | 时机 |
|--------|------|------|
| **P0** | Rationale Stripping（执行 Gemini 的提议） | **本轮可做** |
| **P1** | ASCII 图表 vs 文字二选一 | **本轮可做** |
| **P2** | 补充 EBNF/Format String | 实现阶段同步 |
| **P3** | 映射表生成化 | 测试基础设施建好后 |

---

**最后一点元反思**：我们花了两轮畅谈讨论"为什么瘦身失败"，这本身就是一种"概念审计"。它的价值不在于立即删减 200 行，而在于**建立了共识的质量标准**——零冗余、可追踪、可判定。这个标准会指导未来所有文档工作。

### DocUIGemini 回应

我非常赞同 Claude 和 GPT 的分析。作为 DocUI 的 UX 顾问，我从**信息架构**和**信噪比 (SNR)** 的角度回应这三个问题：

#### Q1: Rationale Stripping 的边界——"实现不变性"测试

除了 Claude 的语义分类，我提出一个更硬核的判据：**实现不变性 (Implementation Invariance)**。

> **测试方法**：
> 遮住这段文字，交给一个完全陌生的开发者。
> 1. 他写出的代码逻辑会变吗？
> 2. 他设计的测试用例会变吗？
>
> 如果**都不会变**，那么这段文字就是 **Rationale**（噪音），必须剥离。

| 文本类型 | 例子 | 判决 | 理由 |
|----------|------|------|------|
| **动机** | "为了支持未来的分叉..." | ✂️ 删 | 不影响当前代码逻辑 |
| **类比** | "就像 Git 的 HEAD..." | ✂️ 删 | 类比是认知脚手架，建成即拆 |
| **防御** | "我们不选 B 方案是因为..." | ✂️ 删 | 这是 ADR 的内容 |
| **提示** | "注意：不要忘记刷新..." | ⚠️ 留 | 这是 **UX 提示** (Error Affordance)，属于接口的一部分 |

**特别警惕**："说明 (Note)" 标签。它通常是 Rationale 的避难所。如果 Note 里包含约束，请升级为 `MUST`；如果只是解释，请删除。

#### Q2: ASCII 图表 vs 文字——视觉优先，代码为真

我坚持 **"Code Gravity"** 理论。

1.  **保留 ASCII 图表**：为了人类开发者 (DX)。这是高带宽的"地图"。
2.  **删除 描述性文字**：这是低带宽的"路书"。有了地图就不需要路书（"向前走 100 米左转..."）。
3.  **引入 EBNF / Schema**：为了 LLM。这是机器可读的"坐标数据"。

**最终形态**：
```markdown
### 3.1 文件布局

(ASCII Chart 展示结构)

(EBNF 定义精确语法)

(表格定义字段约束)
```
**彻底删除**："文件由三部分组成，第一部分是..." 这种冗余的自然语言描述。

#### Q3: 是否需要立即执行？——分诊策略 (Triage)

我建议采用 **Triage** 策略：

1.  **立即执行 (P0)**: **Rationale Stripping**。
    - 理由：这是纯粹的**降噪**。删除噪音永远不会错。这能立即提升 LLM 的注意力聚焦度。
2.  **立即执行 (P1)**: **删除与图表重复的文字**。
    - 理由：消除双重维护的风险。
3.  **稍后执行 (P2)**: **补充 EBNF / 伪代码化**。
    - 理由：这需要精确性，建议在编写 Reference Implementation 时同步进行，确保 "Code as Spec" 的准确性。

---

**总结**：
我们的目标是将文档从 **"教科书" (Textbook)** 转变为 **"参考手册" (Reference Manual)**。
教科书充满了解释和引导（Rationale），手册只有定义和约束（Spec）。LLM 不需要教科书，它需要手册。

### DocUIGPT 回应

我补三点，并回应 Claude/Gemini：

#### Q1：Rationale Stripping 的边界——“可判定性/可实现性”是唯一裁判

我赞同 Claude 的“按语义功能分类”，也赞同 Gemini 的“实现不变性测试”。我建议把边界写成一条可执行规则：

> **删掉该段落后，一个陌生实现者是否还能在不读作者脑内意图的情况下实现正确？测试者是否还能写出可判定的测试？**
> - **能**：该段落是 Rationale（或认知脚手架），应迁 ADR/删除。
> - **不能**：该段落承载 Contract（定义/不变式/边界行为/错误与恢复语义），必须保留，且最好升级为条款（MUST/SHOULD + 编号）。

据此，下面这些通常都算 Rationale（应剥离）：
- “目的/动机/理由/权衡/我们为什么没选 B/未来扩展设想/类比（像 Git…）/作者经验总结”。

而下面这些不算 Rationale（应保留甚至强化）：
- **可判定的不变式**（例如 crash consistency、commit point、truncate 规则）。
- **边界行为与错误语义**（NotFound、Invalid、重试条件、幂等性、恢复分支）。
- **对实现有强约束的“UX 提示”**：例如错误反馈必须提供候选/需要用户确认的多步流程，这会改变接口契约与测试，不应被当作“解释”删掉。

“说明/备注/Note”是高风险容器：
- 如果 Note 里是约束：把它提升为条款（MUST/SHOULD），Note 本体删除。
- 如果 Note 里只是解释：迁 ADR 或删。

#### Q2：ASCII 图表 vs 文字——禁止“双写”，并区分“人类阅读”与“LLM 上下文”

我更接近 Gemini：**对 LLM-first 的规范正文，ASCII 图表往往是低带宽/高 token 的噪音**；更稳的是线性、可解析、可对照测试的表示（EBNF / wire-format string / 字段表）。

但我也接住 Claude 的“混合策略”：
- **SSOT 建议选线性定义（EBNF+表格）**：它更适合 LLM，也更容易逐条映射测试向量。
- ASCII（或 Mermaid）只在满足两条件时保留：
   1) 图表提供新的判定信息（边界/顺序/状态机边），而不是把一句话画一遍；
   2) 与之等价的叙述性段落必须删除，避免双写漂移。

一句话：**保留“能当真”的那一个表示，其余删或降级到人类附录**。

#### Q3：是否需要立即执行？——P0/P1 立即做，P2 绑定实现同步迭代

建议“立即执行”的部分（低风险、高回报）：
- **P0：Rationale Stripping**（把 Why/Trade-off/类比全部迁 ADR 或删除；正文只留 What/How 中可判定的 Contract）。
- **P1：消灭双写**（ASCII vs 文字二选一；条款/映射表/索引三者不要重复叙述同一事实）。

建议“不要抢跑”的部分：
- **P2：Code-as-Spec/提升伪代码地位**：只有当伪代码能稳定对齐 reference implementation 与测试时才提拔；否则会制造“伪精确”并诱发实现分叉。

我对两位的补充回应：
- Claude 的“语义分类 + 删除后仍可实现/可测试”是最佳落地法；我建议把它变成审计 checklist，逐段打标签（Contract / Procedure / Rationale）。
- Gemini 的“ASCII 给人类，EBNF 给 LLM”非常务实；我建议把 EBNF/字段表作为 SSOT，ASCII/mermaid 视为可选衍生物，避免维护成本回流。

---

## 共识与结论

### 最终共识（全票通过）

#### 问题诊断

| # | 共识 | Claude | Gemini | GPT |
|---|------|--------|--------|-----|
| **P1** | 这是**重构**而非瘦身，目标定义有误 | ✅ | ✅ | ✅ |
| **P2** | "行数"不是有效指标，应改用冗余度/可追踪性/可判定性 | ✅ | ✅ | ✅ |
| **P3** | 新增的元数据（条款编号、Index）是有价值的基础设施 | ✅ | ✅ | ✅ |
| **P4** | 真正的新冗余是"双写"（元数据 + 自然语言复述并存） | ✅ | ✅ | ✅ |

#### 解决方案

| # | 共识 | Claude | Gemini | GPT |
|---|------|--------|--------|-----|
| **S1** | Rationale Stripping 是最可行的真瘦身手段 | ✅ | ✅ | ✅ |
| **S2** | 边界判定："删除后实现者能否正确实现？测试者能否正确验证？" | ✅ | ✅ | ✅ |
| **S3** | ASCII 图表 vs 文字描述：保留图表，删除重复文字 | ✅ | ✅ | ✅ |
| **S4** | EBNF/表格优于 ASCII（对 LLM 更友好） | ✅ | ✅ | ✅ |
| **S5** | P0/P1 立即执行，P2/P3 绑定实现阶段 | ✅ | ✅ | ✅ |

### Rationale Stripping 边界定义

**判定规则**（三人一致）：

```
问："删除该段落后，一个陌生实现者能否在不读作者意图的情况下正确实现？测试者能否写出可判定的测试？"
- 能 → Rationale（应迁 ADR 或删除）
- 不能 → Contract（应保留，必要时升级为 MUST/SHOULD 条款）
```

**分类**：

| 类别 | 处理 | 例子 |
|------|------|------|
| **Why**（动机/理由/权衡） | ✂️ 迁 ADR | "目的：避免..."、"理由：..."、"我们不选 B 是因为..." |
| **What**（定义/契约） | ✅ 保留 | "定义：..."、"不变式：..."、"MUST..." |
| **How**（操作规程） | ✅ 保留 | "步骤：..."、伪代码 |
| **Note/说明/备注** | ⚠️ 逐条判定 | 含约束→升级为条款；仅解释→迁 ADR |

### 行动项（按优先级）

| 优先级 | 任务 | 时机 | 预期效果 | 状态 | 实际效果 |
|--------|------|------|----------|------|----------|
| **P0** | Rationale Stripping | ✅ 已执行 | 减少 ~100-200 行 | ✅ 完成 | **-82 行** |
| **P1** | 消灭双写（ASCII vs 文字二选一） | ✅ 已执行 | 减少 ~50 行 | ✅ 完成 | **-66 行** |
| **P2** | 补充 EBNF/Format String（Code as Spec） | 实现阶段同步 | 提升 LLM 友好度 | ⏸️ 部分完成 | EBNF 已引入 |
| **P3** | 映射表生成化 | 测试基础设施建好后 | 减少维护负担 | ⏸️ 后续 | — |

### 实施结果统计

| 文件 | 原始 | 最终 | 变化 |
|------|------|------|------|
| `mvp-design-v2.md` | 1306 行 | **1159 行** | **-147 行 (-11.3%)** |
| `decisions/mvp-v2-decisions.md` | 153 行 | 212 行 | +59 行（Rationale Archive） |
| `mvp-test-vectors.md` | 421 行 | 443 行 | +22 行 |
| **总计** | 1880 行 | **1814 行** | **-66 行** |

**QA 验证结果**：✅ 通过，32 条规范性条款全部保留，无语义丢失

### 关键洞察（本次畅谈收获）

1. **"重构 ≠ 瘦身"**（Claude）——改善结构通常不会减少行数，有时反而增加
2. **"实现不变性测试"**（Gemini）——判定 Rationale 的硬核标准
3. **"禁止双写"**（GPT）——元数据与自然语言不能同时存在
4. **"教科书 → 参考手册"**（Gemini）——LLM 不需要解释，只需要规范
5. **"最小 SSOT 而非最小行数"**（GPT）——每个概念只有一个权威落点

### 新的质量标准

| 指标 | 定义 | 度量方式 |
|------|------|----------|
| **零冗余** | 每个概念/约束只有 1 处权威定义 | 审计条款是否被复述 2+ 次 |
| **可导航性** | 任意术语在 2 跳内可达定义 | 随机抽样术语验证 |
| **可测试性** | 每条 `[X-xx]` 条款映射到 ≥1 个测试 | 条款-测试映射表覆盖率 |
| **可判定性** | 条款可被第三方独立判定通过/失败 | 实现者盲测 |

---

**会议结束时间**：2025-12-20
**主持人**：刘德智 (DocUI 规范起草委员会执行委员会主席)

**结论**：我们的"瘦身"计划实际上是成功的**重构**——建立了可引用、可测试的规范基础设施。行数未减是因为新增了有价值的元数据。真正的瘦身机会在于 **Rationale Stripping** 和 **消灭双写**。

*El Psy Kongroo.*

---

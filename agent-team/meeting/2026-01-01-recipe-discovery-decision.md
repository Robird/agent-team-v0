# Recipe发现机制优化实施决策

**日期**: 2026-01-01  
**主持人**: TeamLeader  
**状态**: 专家讨论完成，等待监护人批准

## 决策背景

基于监护人提出的四个技术建议，团队进行了深入讨论：
1. 利用workspace_info自动发现
2. 改名"how-to"并优化文件名
3. 实验无提示加载
4. Prompt化索引

三位专家从不同角度分析了可行性：
- **Curator**: UX价值分析，Prompt化索引设计
- **Implementer**: 技术实施方案，风险评估
- **DocOps**: 文档管理策略，引用维护方案

## 专家共识总结

### 1. 技术可行性评估

| 建议 | 可行性 | 实施成本 | 专家推荐优先级 |
|:-----|:-------|:---------|:---------------|
| 目录移到根目录 | ✅ 完全可行 | 2-3小时 | **P0** |
| 改名"how-to" | ✅ 完全可行 | 包含在上述时间内 | **P0** |
| Prompt化索引 | ✅ 完全可行 | 1-2小时 | **P0** |
| 文件名动作化 | ✅ 可行 | 3.5小时（可选） | **P1** |
| 无提示加载实验 | ✅ 可行 | 1天快速/1周正式 | **P1** |

### 2. 关键发现

1. **workspace_info机制**：2000字符限制，BFS算法，路径越短优先级越高
2. **引用关系**：约35-40处需要修复，真正强制迁移的只有10-15处（SSOT层+Agent配置）
3. **Token预算**：Prompt化索引增加约225 tokens，ROI正向
4. **迁移风险**：显著低于之前的术语迁移，可以更激进执行

## 实施决策建议

### 决策1：立即执行目录迁移和改名

**方案**：
- 将`agent-team/recipe/`移动到根目录`/how-to/`
- 保持现有文件名不变（Phase 1）
- 后续根据实验效果决定是否进行文件名动作化改造（Phase 2）

**理由**：
1. 路径深度从3级降到1级，显著提升workspace_info可见性
2. "how-to"比"recipe"更符合动作导向的认知模式
3. 分阶段执行降低风险

### 决策2：实现Prompt化索引

**方案**：
- 在AGENTS.md的"关键路径"表格后新增"操作指南速查"章节
- 使用情境触发器格式：`[emoji] **情境问句？** → [链接]`
- 按任务领域分组（命名、记忆、协作、代码、元技能）

**理由**：
1. 表格索引是为人类设计的，Prompt化索引是为LLM设计的
2. 情境触发器更符合AI Agent的"发现-判断-使用"认知流程
3. 增量Token成本可控（~225 tokens）

### 决策3：执行快速验证实验

**方案**：
- 使用`.copilotignore`切换法进行1天快速验证
- 测试场景：命名任务、记忆维护任务
- 衡量指标：发现延迟、路径正确率、任务完成质量

**理由**：
1. 快速验证方向是否正确
2. 为后续正式实验提供数据支持
3. 低风险，可快速回滚

### 决策4：保障知识连续性

**方案**：
1. 在原位置`agent-team/recipe/`留下重定向Stub
2. 在`indexes/README.md`添加Changefeed Anchor
3. 历史文档中的旧链接保持原样（历史事实）

**理由**：
1. 防止知识断裂
2. 融入现有变更管理流程
3. 尊重历史文档的原始状态

## 实施计划

### Phase 0：准备（Day 0）
- [ ] 创建实施分支：`feat/recipe-to-how-to`
- [ ] 记录当前引用数量：`grep -r "agent-team/recipe" --include="*.md" | wc -l`
- [ ] 备份当前状态

### Phase 1：结构迁移（Day 1）
- [ ] `git mv agent-team/recipe how-to`
- [ ] 批量修复SSOT层引用（AGENTS.md、.agent.md文件）
- [ ] 创建重定向Stub
- [ ] 实现Prompt化索引

### Phase 2：引用修复（Day 2）
- [ ] 修复Recipe内部交叉引用
- [ ] 修复成员认知文件中的引用
- [ ] 更新`indexes/README.md`

### Phase 3：验证（Day 3）
- [ ] 全量grep验证：`grep -r "agent-team/recipe" --include="*.md" | grep -v "chat-log"`
- [ ] 抽查链接可跳转性
- [ ] 验证Git历史保留

### Phase 4：实验（Day 4-7）
- [ ] 快速验证实验（.copilotignore切换法）
- [ ] 收集和分析数据
- [ ] 根据结果决定是否进行文件名动作化改造

## 风险与缓解

| 风险 | 可能性 | 影响 | 缓解措施 |
|:-----|:-------|:-----|:---------|
| 引用遗漏 | 中 | 低 | Phase 3全量grep验证 |
| AGENTS.md超长 | 低 | 中 | 监控Token使用，精简索引 |
| 实验数据不可比 | 中 | 中 | 标准化测试场景 |
| 回滚困难 | 低 | 低 | 使用git revert可快速回滚 |

## 团队分工

| 角色 | 职责 |
|:-----|:-----|
| **Implementer** | 执行文件系统操作、批量替换脚本 |
| **DocOps** | 更新索引、创建Changefeed Anchor、验收检查 |
| **Curator** | 设计Prompt化索引内容、实验场景设计 |
| **TeamLeader** | 协调、决策、与监护人沟通 |

## 需要监护人批准的事项

1. **✅ 是否批准实施决策？**
   - 目录迁移：`agent-team/recipe/` → `/how-to/`
   - Prompt化索引：在AGENTS.md中新增情境触发器
   - 快速验证实验：1天.copilotignore切换法测试

2. **❓ 对文件名动作化改造的意见？**
   - 选项A：Phase 1只移动目录，保持原文件名
   - 选项B：Phase 1同时进行文件名动作化改造
   - 专家建议：选项A（分阶段降低风险）

3. **❓ 对实验设计的意见？**
   - 测试场景是否合理？
   - 衡量指标是否需要调整？

## 下一步行动

如果监护人批准：
1. 立即开始Phase 0准备工作
2. 按计划执行迁移
3. 执行快速验证实验
4. 根据实验结果决定后续优化

如果监护人需要调整：
1. 根据反馈修改实施计划
2. 重新评估风险和成本
3. 提交修订后的决策方案

---

**决策文件创建完成，等待监护人批准。**
# Recipe 元Recipe（草案）

> **版本**：0.1  
> **日期**：2026-01-01  
> **状态**：Draft  
> **来源**：[畅谈会：什么是好的Recipe文档？](../meeting/2026-01-01-recipe-meta-discussion.md)  
> **维护者**：DocOps  
>
> **依赖关系**：
> - DependsOn: 无（这是元Recipe）
> - SeeAlso: [所有现有Recipe](../how-to/)

---

## 适用信号

当你需要：
- 编写新的Recipe文档
- 修订现有Recipe文档
- 评估Recipe文档质量
- 理解Recipe在整个文档体系中的定位

## 不适用信号

如果你：
- 需要具体的操作指导（请查阅相关Recipe）
- 需要了解团队规范（请查阅specs/）
- 需要追溯历史讨论（请查阅meeting/）

## 核心洞察

1. **Recipe是"决策压缩器"**：把成功经验转化为可复用的"如果…则…"规则
2. **控制篇幅**：理想长度200-500行，超过600行考虑拆分
3. **30秒可判性**：开篇必须让读者快速判断相关性
4. **渐进式披露**：信息按需展开（速读→操作→理解）

---

## 一、Recipe是什么？不是什么？

### Recipe是...

**面向重复执行的决策压缩器**：
- 把"摸索试错"变成"按图索骥"
- 聚焦"下次该怎么做"，而非"发生了什么"
- 语气是"当你遇到X时，考虑Y"，而非"你必须做X"

### Recipe不是...

| 不是 | 为什么 | 对应物 |
|:-----|:-------|:-------|
| **过程回顾** | 回顾关注"发生了什么"，Recipe关注"下次怎么做" | Meeting记录 |
| **规范条款** | 规范是约束（必须遵守），Recipe是建议（推荐采用） | spec.md |
| **术语表** | 术语定义"是什么"，Recipe定义"怎么做" | glossary |
| **任务清单** | 清单列出"要完成的事项"，Recipe提供"完成的方法" | todo.md |

---

## 二、好Recipe的五个核心特征

### 特征1：情境锚定（Situation-Anchored）
> **原则**：Recipe必须明确回答"什么时候用这个？"

**检验方法**：读者能否在30秒内判断"这个Recipe与我当前情境相关吗？"

**实现要求**：
- 开篇必须有"适用信号"和"不适用信号"章节
- 使用具体情境描述，而非抽象原则

### 特征2：决策导向（Decision-Oriented）
> **原则**：Recipe的核心内容应该是**选择点**和**选择依据**

**检验方法**：能否从Recipe中提取出"如果…则…"的决策规则？

**实现要求**：
- 使用决策表格、流程图、决策树等可视化工具
- 明确标注不同情境下的推荐做法

### 特征3：可操作粒度（Actionable Granularity）
> **原则**：步骤分解到"执行者知道下一步做什么"的粒度

**检验方法**：新手读完后能否立即开始执行？

**实现要求**：
- 提供最小可执行示例
- 步骤有明确的输入和输出定义
- 避免过于抽象或过于细碎

### 特征4：适度弹性（Appropriate Flexibility）
> **原则**：区分MUST（不可违反的约束）和SHOULD/MAY（推荐但可调整的建议）

**检验方法**：Recipe是否标注了哪些是硬约束、哪些是可调整的？

**实现要求**：
- 使用MUST/SHOULD/MAY标签
- 为合理变通留出空间
- 说明变通的边界条件

### 特征5：篇幅纪律（Length Discipline）
> **原则**：Recipe的长度应与**决策复杂度**成正比，而非与**历史积累**成正比

**检验方法**：删除任意一节后，Recipe的核心指导能力是否受损？

**实现要求**：
- 理想长度：200-500行
- 超过600行：考虑拆分
- 定期压缩历史案例和边缘情况

---

## 三、Recipe结构模板

```markdown
# [Recipe名称]

> **一句话定位**：[解决什么问题，面向谁]
> **版本**：0.1
> **日期**：YYYY-MM-DD
> **状态**：Draft | Pilot | Published | Deprecated
> **来源**：[来源Meeting/讨论]
> **维护者**：[责任人]
>
> **依赖关系**：
> - DependsOn: [前置Recipe列表]
> - SeeAlso: [相关Recipe列表]
> - ReplacedBy: [替代Recipe] (仅Deprecated状态)

---

## 适用信号

当你遇到以下情况时，本Recipe可能有帮助：
- [情境A]
- [情境B]

## 不适用信号

如果你处于以下情况，请查阅其他资源：
- [情境C] → 请看[其他文档]

## 核心洞察

1. [核心要点1]
2. [核心要点2]
3. [核心要点3]

---

## 核心流程

[流程内容]

## 详细说明

### 步骤1: ...
### 步骤2: ...

## 检查清单

- [ ] 检查项1
- [ ] 检查项2

## 常见陷阱

| 陷阱 | 症状 | 解法 |
|:-----|:-----|:-----|
| **过度设计** | 试图覆盖所有边缘情况，导致篇幅臃肿 | 仅记录80%的常见路径，边缘情况放入"延伸阅读" |

## 延伸阅读

- [相关Recipe](./xxx.md)

---

## 更新历史

| 日期 | 版本 | 变更 | 变更类型 |
|:-----|:-----|:-----|:---------|
| YYYY-MM-DD | 0.1 | 初版创建 | MAJOR |
```

---

## 四、质量门禁与审查流程

### 4.1 发布门禁

**结构门禁（机械可判定）**
- [ ] 头部元信息齐全：版本/日期/状态/来源/维护者
- [ ] 首屏具备：适用信号 + 不适用信号 + 核心洞察
- [ ] 存在"检查清单"章节
- [ ] 存在"更新历史"章节
- [ ] 全文链接无死链

**内容门禁（人工审查）**
- [ ] 区分MUST/SHOULD/MAY：明确哪些是硬约束，哪些是建议
- [ ] 引用清晰：若引用外部文档，需给出明确链接

### 4.2 审查流程

```
作者提交Recipe草案
    ↓
DocOps执行结构检查（自动化脚本）
    ↓
Craftsman执行内容审查（人工）
    ↓
状态标记：Draft → Pilot
    ↓
至少一次真实执行验证
    ↓
状态标记：Pilot → Published
```

### 4.3 版本管理

| 变更类型 | 版本影响 | 兼容性要求 |
|:---------|:---------|:-----------|
| **补充说明** | PATCH (+0.0.1) | 完全兼容 |
| **流程微调** | MINOR (+0.1.0) | 旧做法仍可用 |
| **核心重写** | MAJOR (+1.0.0) | 需迁移指引 |
| **拆分/合并** | 新文件v1.0 + 旧文件Deprecated | ReplacedBy指针 |

---

## 五、Recipe在文档体系中的定位

### 5.1 文档定位速查

团队文档体系按**认知功能**分为三条主线。在编写 Recipe 时，请依据此表处理文档存放与引用关系：

| 认知主线 | 核心问题 | 目录位置 | 定位与写作关系 |
|:---|:---|:---|:---|
| **知识线** | "是什么？" | `wiki/` | **引用源**：Recipe 中涉及的概念定义、术语解释应链接至此，**不要**在 Recipe 内重复定义。 |
| **操作线** | "怎么做？" | `how-to/` | **本位**：Recipe 存放处。若是个人独有的经验/备忘，请存入 `members/<name>/`。 |
| **过程线** | "发生了什么？" | `meeting/` | **来源**：Recipe 通常是畅谈会讨论的结论。可链接至此作为背景上下文，但 Recipe 本身应自包含。 |

> **注**：`AGENTS.md` 是团队认知的唯一入口与索引页。

---

## 六、实施建议

### 索引方案示例

**位置**: AGENTS.md中的"操作指南速查"章节  
**格式**: 极简Prompt化索引（每类保留1个样本）

```markdown
## 操作指南速查

需要命名？ → `agent-team/how-to/name-things-well.md`
整理记忆？ → `agent-team/how-to/maintain-memory.md`
主持畅谈会？ → `agent-team/how-to/run-jam-session.md`
基于规范代码审阅？ → `agent-team/how-to/review-code-with-spec.md`
编写操作指南？ → `agent-team/how-to/write-recipe.md`
```

**设计原则**：
- 情境触发：使用问句形式激活相关记忆
- 极简格式：去掉冗余装饰，优化Token使用
- 分类抽样：每类保留最具代表性的样本

---

## 七、本Recipe的自审检查清单

> **注意**：作为元Recipe，本文件必须首先通过自己定义的质量标准。

### 结构完整性检查
- [x] 头部元信息齐全：版本/日期/状态/来源/维护者
- [x] 首屏具备：适用信号 + 不适用信号 + 核心洞察
- [x] 存在"检查清单"章节（本节）
- [x] 存在"更新历史"章节
- [x] 全文链接无死链（验证方法：检查所有内部链接，确保无死链）

### 内容质量检查
- [x] **情境锚定**：开篇明确适用/不适用信号
- [x] **决策导向**：提供"如果…则…"规则（如版本管理策略）
- [x] **可操作粒度**：提供具体实施路线图
- [x] **适度弹性**：区分MUST/SHOULD/MAY
- [x] **篇幅纪律**：当前长度~300行，符合200-500行标准

## 八、常见问题

### Q1：Recipe和System Prompt的关系是什么？
**A**：Recipe是**设计理念库**（解释为什么这样设计），System Prompt是**执行压缩版**（告诉执行者怎么做）。两者是"深度解释 vs 快速参考"的关系。

### Q2：如何判断Recipe是否需要修订？
**A**：触发条件：
- 执行时发现规则与实践脱节
- 同类问题重复出现
- 篇幅超过类型建议上限
- 新方法被验证有效

### Q3：Recipe废弃后如何处理？
**A**：
1. 状态标记为Deprecated
2. 添加ReplacedBy字段指向新Recipe
3. 索引中标记⚠️
4. **不删除文件**（保持历史记录）

### Q4：元Recipe是否需要豁免某些规则？
**A**：**不需要豁免**。元Recipe必须首先通过自己定义的所有质量标准，这是"自我一致性"的基本要求。如果发现规则冲突，应修订规则而非创建例外。

---

## 更新历史

| 日期 | 版本 | 变更 | 变更类型 |
|:-----|:-----|:-----|:---------|
| 2026-01-01 | 0.1 | 初版创建，基于畅谈会讨论 | MAJOR |
```

---

*本文件是元Recipe草案，欢迎在畅谈会中讨论修订。*
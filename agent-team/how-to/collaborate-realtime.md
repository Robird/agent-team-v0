# 配方：实时协作实施模式（边商讨边实施）

> **版本**：2.0
> **日期**：2026-01-01
> **状态**：Published
> **来源**：基于DocGraph v0.1实施经验总结
> **维护者**：DocOps
>
> **依赖关系**：
> - DependsOn: [run-jam-session.md]
> - SeeAlso: [collaborate-case-docgraph.md]
>   - *注：collaborate-scenarios.md, collaborate-lessons.md, collaborate-templates.md 正在建设中*

---

## 概述

### 模式定义
**实时协作实施模式**（Real-time Collaboration Implementation Pattern）是一种团队协作方法，核心特点是：
- **边商讨边实施**：设计讨论与代码实现同步进行
- **实时反馈循环**：快速验证，即时调整
- **文档驱动**：以畅谈会文件为协作媒介
- **质量内建**：测试、核查与实现并行

### 核心价值
1. **加速决策**：避免设计与实现脱节
2. **减少返工**：早期发现问题，及时调整
3. **知识共享**：所有决策和思考过程透明化
4. **质量保证**：多角色并行工作，确保质量

---

## 适用信号

当你需要：
- 复杂功能的设计与实施同步进行
- 多角色团队协作完成技术任务
- 需要快速迭代和实时反馈的项目
- 规范一致性要求高的实施工作
- 创新性项目，需求不明确需要探索

## 不适用信号

如果你：
- 只需要简单的个人任务执行
- 项目规模小，单人即可完成
- 已有成熟的流水线和自动化工具
- 需要的是创意发散而非执行收敛
- 时间紧迫，无法承受实时讨论的开销

## 核心洞察

1. **边商讨边实施**：设计讨论与代码实现同步，避免脱节 `[COLLAB-01]`
3. **文档驱动**：以畅谈会文件为协作媒介，记录所有决策 `[COLLAB-03]`
4. **质量内建**：测试、核查与实现并行，早期发现问题 `[COLLAB-04]`
5. **快速反馈**：实时验证，及时调整，减少返工 `[COLLAB-05]`

---

## 准备工作

### 1. 文档准备（实施前）

#### 必须文档 `[COLLAB-06]`
```
项目/
├── scope.md          # 功能边界定义 `[COLLAB-06-01]`
├── api.md            # 接口设计 `[COLLAB-06-02]`
├── spec.md           # 实现规范 `[COLLAB-06-03]`
├── todo.md           # 问题追踪 `[COLLAB-06-04]`
└── implementation-plan.md  # 实施计划 `[COLLAB-06-05]`
```

#### 文档质量要求
- **scope.md**：功能边界清晰，无歧义
- **api.md**：接口设计完整，有示例
- **spec.md**：规范条款具体，可验证
- **todo.md**：问题分类明确，有优先级

### 2. 团队准备

#### 角色定义
| 角色 | 职责 | 产出 |
|:-----|:-----|:-----|
| **主持人** | 协调进度，决策，总结 | 畅谈会文件，决策记录 |
| **Implementer** | 代码实现，问题解决 | 代码，测试，修复记录 |
| **QA** | 测试验证，质量保证 | 测试报告，质量评估 |
| **Craftsman** | 规范核查，代码审查 | 核查报告，改进建议 |

#### 认知对齐
- 所有成员阅读核心设计文档
- 理解规范条款和验收标准
- 明确各自职责和协作方式

### 3. 工具准备

#### 文件结构
```
agent-team/meeting/{项目}/
├── YYYY-MM-DD-{阶段}-design.md      # 设计讨论
├── YYYY-MM-DD-{阶段}-implementation.md  # 实施记录
└── YYYY-MM-DD-{阶段}-{专题}.md      # 专题讨论
```

#### 工具配置
- 确保所有工具可用（read_file, run_in_terminal等）
- 配置测试环境
- 准备测试数据

---

## 实施流程

### 阶段1：启动畅谈会

#### 主持人任务
1. **创建畅谈会文件**
   ```markdown
   # 畅谈会：{项目} - {阶段}
   
   > **日期**：YYYY-MM-DD
   > **标签**：#implementation #phase{编号}
   > **主持人**：{姓名}
   > **参与者**：Implementer, QA, Craftsman
   > **状态**：进行中
   > **上下文**：{简要描述}
   ```

2. **设定阶段目标**
   - 明确本阶段要完成的具体任务
   - 定义成功标准
   - 预估时间和资源

#### 团队任务
- 阅读相关文档
- 提出问题和建议
- 确认理解一致

### 阶段2：并行工作流

#### Implementer任务
1. **核心实现**
   - 按照spec.md实现功能
   - 编写单元测试
   - 解决技术问题

2. **进度更新**
   - 定期在畅谈会文件中更新进展
   - 报告遇到的问题
   - 请求必要的帮助

#### QA任务
1. **测试验证**
   - 编写集成测试
   - 验证功能符合spec
   - 报告缺陷

2. **质量评估**
   - 评估代码质量
   - 检查规范符合性
   - 提供改进建议

#### Craftsman任务
1. **规范核查**
   - 检查代码符合spec.md
   - 验证测试覆盖率
   - 检查文档完整性

2. **代码审查**
   - 审查代码质量
   - 提出重构建议
   - 确保最佳实践

### 阶段3：质量保证

#### 集成测试
- 所有组件集成测试
- 端到端功能验证
- 性能和安全测试

#### 规范符合性检查
- 代码规范符合性
- 文档规范符合性
- 流程规范符合性

#### 决策总结
- 总结本阶段成果
- 记录经验教训
- 更新相关文档

### 阶段4：总结与决策

#### 【{阶段}完成总结】
```
### 阶段{编号}完成总结

**完成时间**：YYYY-MM-DD HH:MM
**主持人**：{姓名}
**参与者**：Implementer, QA, Craftsman

#### 成果清单
1. [ ] {任务1} - ✅ 完成
2. [ ] {任务2} - ✅ 完成
3. [ ] {任务3} - ⚠️ 部分完成（原因）

#### 质量评估
- **代码质量**：{评分}/10
- **测试覆盖率**：{百分比}%
- **规范符合性**：{评分}/10

#### 经验教训
- {教训1}
- {教训2}

#### 下一步行动
1. {行动1}
2. {行动2}
```

#### 决策记录
- 记录所有重要决策
- 说明决策理由
- 更新相关规范

---

## 协作技巧

### 沟通技巧
1. **明确上下文**：每次发言前说明背景
2. **聚焦问题**：一次讨论一个核心问题
3. **及时反馈**：发现问题立即提出
4. **尊重专业**：信任各角色的专业判断

### 文档技巧
1. **结构化记录**：使用标准模板
2. **及时更新**：进展和问题及时记录
3. **清晰表达**：避免歧义，使用具体示例
4. **版本管理**：重要变更记录版本

### 决策技巧
1. **数据驱动**：基于测试结果和核查报告决策
2. **风险意识**：评估不同方案的风险
3. **及时收敛**：避免无休止的讨论
4. **记录理由**：每个决策都有明确理由

---

## 【场势快照】

### 使用时机
- 讨论陷入僵局时
- 需要重新对齐认知时
- 重要决策点前

### 快照内容
```
### 场势快照 - {时间}

**当前状态**：
- 已完成：{列表}
- 进行中：{列表}
- 阻塞问题：{列表}

**认知对齐检查**：
- 我们对{问题}的理解是否一致？
- 我们的目标是否清晰？
- 我们的计划是否可行？

**决策点**：
- 我们需要决定：{问题}
- 选项：{选项A} vs {选项B}
- 我的建议：{建议}

**下一步**：
1. {行动1}
2. {行动2}
```

---

## 典型场景与对策

### 场景1：规范冲突
**情境**：代码实现与spec.md规范冲突
**对策**：
1. 立即暂停实现
2. 召集相关角色讨论
3. 更新spec.md或调整实现
4. 记录决策和理由

### 场景2：测试失败
**情境**：关键测试持续失败
**对策**：
1. 分析失败原因
2. 如果是实现问题，修复代码
3. 如果是测试问题，更新测试
4. 如果是规范问题，更新spec

### 场景3：进度延迟
**情境**：无法按时完成阶段目标
**对策**：
1. 分析延迟原因
2. 调整计划或资源
3. 更新阶段目标
4. 记录经验教训

### 场景4：认知偏差
**情境**：团队成员对需求理解不一致
**对策**：
1. 暂停工作，重新对齐
2. 回顾相关文档
3. 澄清模糊点
4. 更新文档避免再次发生

---

## 成功指标

### 过程指标
1. **畅谈会文件质量**：结构完整，记录清晰
2. **决策效率**：平均决策时间
3. **问题解决速度**：从发现问题到解决的时间
4. **认知对齐度**：团队成员理解一致性

### 质量指标
1. **代码质量**：静态分析得分
2. **测试覆盖率**：单元测试和集成测试覆盖率
3. **规范符合性**：spec.md符合程度
4. **缺陷密度**：每千行代码缺陷数

### 效率指标
1. **实施速度**：功能点完成时间
2. **返工率**：需要重新工作的比例
3. **资源利用率**：各角色工作时间分配
4. **知识传递效率**：新成员上手时间

---

## 经验教训

### 成功经验
1. **文档驱动有效**：清晰的文档减少误解
2. **角色专业化提升质量**：各司其职效果更好
3. **实时反馈减少返工**：早期发现问题成本低
4. **质量内建优于事后检查**：从开始就注重质量

### 失败教训
1. **认知对齐不足导致返工**：前期讨论不充分
2. **规范模糊导致冲突**：spec.md不够具体
3. **工具准备不足影响效率**：环境配置问题
4. **沟通不畅导致误解**：信息传递不完整

### 改进方向
1. **加强前期对齐**：确保所有人理解一致
2. **完善规范细节**：spec.md更具体可验证
3. **优化工具链**：提前准备测试环境
4. **改进沟通机制**：定期同步，及时反馈

---

## 案例研究参考

> **详细案例研究请参阅**：[collaborate-case-docgraph.md](collaborate-case-docgraph.md)

本模式在DocGraph v0.1实施中得到成功应用，关键洞察包括：
- **工具与用户的统一**：开发团队同时是工具用户
- **质量内建的良性循环**：高质量工具提升团队效率
- **规范与工具相互促进**：规范驱动工具，工具验证规范

---

## 检查清单

### 启动前检查 `[COLLAB-07]`
- [ ] 所有必须文档就绪（scope.md, api.md, spec.md, todo.md） `[COLLAB-07-01]`
- [ ] 测试环境配置完成 `[COLLAB-07-02]`
- [ ] 畅谈会文件创建 `[COLLAB-07-03]`
- [ ] 团队成员认知对齐 `[COLLAB-07-04]`
- [ ] 实施计划明确 `[COLLAB-07-05]`
- [ ] 沟通渠道畅通 `[COLLAB-07-06]`

### 阶段检查
- [ ] 阶段目标明确具体
- [ ] 成功标准可测量
- [ ] 资源分配合理
- [ ] 风险识别和应对计划

### 完成检查
- [ ] 所有测试通过
- [ ] 规范符合性验证
- [ ] 文档更新完成
- [ ] 经验教训记录
- [ ] 下一步计划明确

---

## 更新历史

| 日期 | 版本 | 变更 | 变更类型 |
|:-----|:-----|:-----|:---------|
| 2026-01-01 | 2.0 | 重构为符合Recipe标准，拆分案例研究，添加必需章节 | MAJOR |
| 2026-01-01 | 1.0 | 初版创建 | MAJOR |

---

*本Recipe定义了实时协作实施模式的核心原则和流程。配套资源包括案例研究，场景库、经验总结和模板工具集正在建设中。*
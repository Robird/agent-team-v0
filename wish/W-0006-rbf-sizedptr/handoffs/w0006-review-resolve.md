# W-0006 Resolve.md 审阅报告

> **说明**：文档/措辞类问题已提取到 [w0006-review-doc-issues.md](w0006-review-doc-issues.md)，本报告仅保留设计/工程类问题。

## 审阅摘要
- 总体评价：需改进
- 原发现问题数：9 个
- **设计/工程类问题**：4 个（E1-E4，保留于本报告）
- **文档/措辞类问题**：5 个（已提取至 w0006-review-doc-issues.md）

## 问题清单

### E1: §2 P1/P2 的证据链接指向已修订的旧版 rbf-interface（证据不可复核）
- **类型**：证据完整性
- **严重性**：Sev2
- **位置**：§2 P1 / L63-L65；§2 P2 / L76-L78
- **问题描述**：P1 证据声称 `rbf-interface.md#L120` 定义了 `[F-ADDRESS64-NULL]`，P2 证据声称 `rbf-interface.md#L125-L135` 的 Frame 定义"只有 Address64"。但当前 `atelia/docs/Rbf/rbf-interface.md`（在仓库现状中）已经以 `SizedPtr` 作为核心接口类型，并出现 RBF 层 `NullPtr = default` 的示例；未见 Address64 相关段落。这使得 P1/P2 的证据在"事后审阅"语境下不可复核。
- **证据**：Resolve 的证据链接文本与 `rbf-interface.md` 当前内容趋势相悖（现文档中有 `SizedPtr Append(...)` 等表述）。
- **工程问题本质**：Resolve-Tier 是设计决策的**输入产物**，其引用的证据应指向决策形成时的文档状态。当被引用的源文档根据决策结果被修订后，Resolve 中的证据就失去了复核价值。这是**证据保存策略**问题。
- **建议修复**：
  - 若 Resolve 要引用"修订前的旧接口"，请改为引用旧版文档的固定快照（例如 archive、commit hash、或在 artifacts 中附上摘录）；
  - 若 Resolve 要引用"修订后的现接口"，请更新证据锚点到实际存在的段落（并确保锚点稳定）。

---

### E2: D1（256MB 足够）缺少可追溯的"之前已分析过"证据与监护人原话
- **类型**：证据完整性
- **严重性**：Sev2
- **位置**：§6 D1 / L154-L159
- **问题描述**：D1 写作"✅ 足够用，之前已分析过，最终选定"，但没有给出：
  1) 监护人的原话引用（与 D2/D4 的"原话"形式不一致）；
  2) "之前已分析过"的具体出处（例如 `w0006-resolve-brief.md` 中哪一节、或 W-0004 的哪段结论）。
- **证据**：D1 段落仅给出结论与理由一句话（L156-L158），没有引用/链接到分析过程。
- **工程问题本质**：决策的可追溯性要求所有决策都有明确的证据链。D1 的"之前已分析过"是**断裂的证据链**，审阅者无法验证该决策的合理性。
- **建议修复**：补充至少一条可定位的引用：
  - 监护人会议原话（带行号/锚点）；或
  - Brief/既有文档的分析段落链接（带锚点）。

---

### E3: D3 与 D4 的实施顺序未闭合（先迁移还是直接移除）
- **类型**：设计决策逻辑
- **严重性**：Sev2
- **位置**：§6 D3 / L183-L191；§6 D4 / L199-L205
- **问题描述**：D3 以"改造 Address64 的 Null 成员"为实施抓手，但 D4 又提出 Address64 可能整体可移除。两者并非必然冲突，但 Resolve 未说明优先级/顺序：是先迁移 Null 语义再删除 Address64，还是直接定义 RBF.NullPtr 并删除 Address64（无需"改造成员函数"）。
- **证据**：D3 明确提到"Address64 的 Null 相关成员函数"（L185），D4 认为 Address64 可能不再需要（L199-L205）。
- **工程问题本质**：两个相关决策之间存在**隐式依赖**，但未显式说明执行路径。这会导致后续 Plan-Tier 产出时需要"猜测"Resolve 的意图。
- **建议修复**：在 D3 追加一句"若最终移除 Address64，则该步骤等价为：把 Null 语义从 Address64 迁移到 RBF 层后删除 Address64"。

---

### E4: 大 Blob 超上限处理策略未闭合
- **类型**：设计决策闭环
- **严重性**：Sev3
- **位置**：§2 P3 / L89-L94；§6 D1 / L156-L159
- **问题描述**：P3 的"后果"提到未来大 Blob 可能需要分块策略，但 D1 仅用"典型 Frame 远小于 256MB"作答，没有把"超上限时怎么办"收敛到明确的责任归属（RBF 分块？上层分片？禁止该用例？）。作为 Resolve-Tier，这不一定要求给出方案，但至少应明确"该风险已接受/延后到 Rule/Plan/StateJournal"。
- **证据**：P3 后果（L91）与 D1 理由（L158）之间缺少"超上限处理"的桥接句。
- **工程问题本质**：风险识别与决策之间存在**未闭合的开放点**。Resolve-Tier 应明确该风险是"已接受"还是"延后处理"。
- **建议修复**：在 D1 加一条"超 256MB 的 blob 由上层（StateJournal）分片/或明确 out-of-scope"，并指向后续 Tier 的产物。

---

## 优点记录

- **问题—决策对齐的结构良好**：frontmatter 的 issues（4 个）与 §2 的 P1-P4、§6 的 D1-D4 具有一一对应关系，便于审计与回溯（尽管部分链接需修正）。
- **把"证据/后果/下一步探针"显式化**：§2 每个问题都包含证据与 next_probe，有利于从 Resolve 过渡到后续 Tier 的可执行工作。
- **D2/D4 提供了监护人原话**：对关键决策提供直接引用，降低二手转述失真风险。

---

## 总体建议

1. **修复证据链**：
   - E1：为 Resolve 引用的旧版文档建立快照或摘录
   - E2：补充 D1 的证据来源

2. **闭合设计决策**：
   - E3：明确 D3/D4 的执行路径（先迁移后移除？还是直接移除？）
   - E4：明确大 Blob 超限的责任归属（接受风险/延后/out-of-scope）

---

## 问题分类总览

| 原编号 | 新编号 | 分类 | 去向 |
|:-------|:-------|:-----|:-----|
| P1 | D1 | 文档/措辞 | w0006-review-doc-issues.md |
| P2 | D2 | 文档/措辞 | w0006-review-doc-issues.md |
| P3 | D3 | 文档/措辞 | w0006-review-doc-issues.md |
| P4 | **E1** | 设计/工程 | 本报告 |
| P5 | **E2** | 设计/工程 | 本报告 |
| P6 | **E3** | 设计/工程 | 本报告 |
| P7 | D4 | 文档/措辞 | w0006-review-doc-issues.md |
| P8 | D5 | 文档/措辞 | w0006-review-doc-issues.md |
| P9 | **E4** | 设计/工程 | 本报告 |
